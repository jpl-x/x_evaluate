###########################
# Initial state estimates #
###########################

p:    [0, -3, 1] # [x,y,z]
v:    [0.0, 0.0, 0.0] # [x,y,z]
q:    [1.0, 0.0, 0.0, 0.0] # [w,x,y,z]

# Initial IMU bias estimates
b_w: [0.0, 0.0, 0.0] # [x,y,z]
b_a: [0.0, 0.0, 0.0] # [x,y,z]

###############
# Calibration #
###############

## ORIGINAL RPG YAML CALIBRATION FILE:

#label: "DAVIS-IJRR17"
#id: a0652606b3d9fd6b62f5448a9e1304be
#cameras:
#  - camera:
#      label: dvs
#      id: 07e806d3367b4a6fa18a52178e4bbaf9
#      line-delay-nanoseconds: 0
#      image_height: 180
#      image_width: 240
#      type: pinhole
#      intrinsics:
#        cols: 1
#        rows: 4
#        data: [199.37143467278824, 199.7078674353677, 133.75438071590816, 113.99216995027632]
#      distortion:
#        type: radial-tangential
#        parameters:
#          cols: 1
#          rows: 4
#          data: [-0.38289915571515265, 0.18933636521343228, -0.0010024743349031492, -0.0005637766302076818]
#    T_B_C:
#      cols: 4
#      rows: 4
#      data: [0.999905117246, -0.0122374970355, 0.00632456886338, 0.00674696422488,
#             0.0121780171243, 0.999882045134, 0.00935904469797, 0.0007279224709,
#             -0.00643835413146, -0.00928113597812, 0.99993620202, 0.0342573613538,
#             0.0, 0.0, 0.0, 1.0]

cam1_fx: 0.8307143111366176
cam1_fy: 1.1094881524187095
cam1_cx: 0.5573099196496173
cam1_cy: 0.6332898330570906
# TODO: calibration models do not match - above radial-tangential with 4 params used, here only 1 double accepted
cam1_s:  -0.38289915571515265
cam1_img_width: 240
cam1_img_height: 180
cam1_q_ic: [0.999965419952174, 0.004660206319180, -0.003190841088148, -0.006104089619662]
cam1_p_ic: [0.00674696422488, 0.0007279224709, 0.0342573613538] # [x,y,z]
cam1_time_offset: 0.0

cam2_fx: 0.8307143111366176
cam2_fy: 1.1094881524187095
cam2_cx: 0.5573099196496173
cam2_cy: 0.6332898330570906
cam2_s:  -0.38289915571515265
cam2_img_width: 240
cam2_img_height: 180
cam2_q_ic: [0.999965419952174, 0.004660206319180, -0.003190841088148, -0.006104089619662]
cam2_p_ic: [0.00674696422488, 0.0007279224709, 0.0342573613538] # [x,y,z]
cam2_time_offset: 0.0

# Feature noise (normalized coordinate standard deviation)
sigma_img: 0.02541924711215672 # sqrt(0.00012922762474977756 * 5.0)

#######
# IMU #
#######

# MXR9500G/M accels (Astec)
n_a:  0.0083  # Accel noise spectral density [m/s^2/sqrt(Hz)]
n_ba: 0.00083 # Accel bias random walk [m/s^3/sqrt(Hz)]
# ADXRS610 gyros (Astec)
n_w:  0.0013  # Gyro noise spectral density [rad/s/sqrt(Hz)]
n_bw: 0.00013 # Gyro bias random walk [rad/s^2/sqrt(Hz)]

#######
# LRF #
#######

# Noise (standard deviation in m)
sigma_range: 0.05

##############
# Sun Sensor #
##############

# Currently unused
q_sc: [1.0, 0.0, 0.0, 0.0] # [w,x,y,z]
w_s: [0.0, 0.0, 1.0] # [x,y,z]

###########
# Tracker #
###########

fast_detection_delta: 20
non_max_supp: True
block_half_length: 20
margin: 20
n_feat_min: 400
# RANSAC: 8 / LMEDS: 4 (see OpenCV doc)
outlier_method: 8
# Parameter used for RANSAC. It is the maximum distance from a point to an epipolar line in pixels,
# beyond which the point is considered an outlier and is not used for computing the final fundamental
# matrix. It can be set to something like 1-3, depending on the accuracy of the point localization,
# image resolution, and the image noise.
outlier_param1: 0.3
# Parameter used for the RANSAC or LMedS methods only. It specifies a desirable level of confidence
# (probability) that the estimated matrix is correct.
outlier_param2: 0.99
# 1 <=> no tiling
n_tiles_h: 1
n_tiles_w: 1
max_feat_per_tile: 10000

########
# EKLT #
########

eklt_batch_size: 300
eklt_update_every_n_events: 20
eklt_displacement_px: 0.6
eklt_patch_size: 25
eklt_max_num_iterations: 10
eklt_tracking_quality: 0.6
eklt_bootstrap: "klt"
eklt_lk_window_size: 20
eklt_num_pyramidal_layers: 3
eklt_scale: 4
eklt_display_features: true
eklt_display_feature_id: false
eklt_display_feature_patches: false
eklt_arrow_length: 5

eklt_max_corners: 100
eklt_min_corners: 0
eklt_min_distance: 10
eklt_quality_level: 0.01
eklt_log_eps: 0.01
eklt_block_size: 3
eklt_k: 0.04

eklt_first_image_t: -1
eklt_tracks_file_txt: ""

##############
# SLAM-MSCKF #
##############

# Number of poses in the sliding window
n_poses_max: 10

# Number of SLAM features
n_slam_features_max: 15

# Initial inverse depth of SLAM features [1/m]
# (default: 1 / (2 * d_min) [Montiel, 2006])
rho_0: 2.5

# Initial standard deviation of SLAM inverse depth [1/m]
# (default: 1 / (4 * d_min) [Montiel, 2006])
sigma_rho_0: 1.25

# Number of IEKF iterations (1 <=> EKF)
iekf_iter: 1

# Minimum baseline to trigger MSCKF measurement (pixels)
msckf_baseline: 30.0

# Minimum track length for a visual feature to be processed
min_track_length: 10

########
# Misc #
########

# Timeout before 3D trajectory disappears in GUI (s)
traj_timeout_gui: 3

# flags to play rosbags
/use_sim_time: True

# Initialize at startup
init_at_startup: False
